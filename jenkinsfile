pipeline {
    agent any
    stages {
        stage('Checkout') { 
            steps {
              sh "git clone https://github.com/anilpu3/hello-world-war"
            }
        }
stage('Maven Build') { 
            steps {
              sh "mvn clean package"
            }
        }  
              
stage('Build Docker Image') {
         steps {
         sh "docker build -t build_cicd:1.0 /var/lib/jenkins/workspace/testin/target"
        }
      }
 stage('Docker hub login and Publish') {
            steps {
            withCredentials([string(credentialsId: 'anilpu3', variable: 'dochubpasswd')]) {
          sh "docker login -u anilpu3@gmail.com -p ${dochubpasswd}"
          sh "docker push build_cicd:1.0 anilpu3/cicd-build-docker-repo build_cicd:1.1"
    }

      }          
        
    }
}
}
